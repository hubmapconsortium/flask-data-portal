# TODO: Eventually, this should be documented in the OpenAPI,
# and enforced by the server... but working here for now
# to get development started. When it is in OpenAPI,
# this should be deleted. https://github.com/hubmapconsortium/entity-api/issues/6

# NOTE: The *_TODO fields are accessed programmatically,
# so when there is a failure we can give more information in the UI.
# They should be Github issue URLs.

$schema: http://json-schema.org/draft-07/schema#
$id: https://github.com/hubmapconsortium/portal-ui/#entity"
title: portal-ui entity validation
type: object

required_TODO: https://github.com/hubmapconsortium/entity-api/issues/17
required:
  - doi_suffix
  - display_id

additionalProperties: false

definitions:
  uuid:
    type: string
    pattern_TODO: https://github.com/hubmapconsortium/entity-api/issues/20
    pattern: '^[0-9a-f]{8}(-[0-9a-f]{4}){3}-[0-9a-f]{12}$'

  time_stamp:
    # TODO: Set lower bound.
    type: integer

  date_time:
    # NOTE: These are added to the response by the portal-ui client.
    type: string
    pattern_TODO: https://github.com/hubmapconsortium/entity-api/issues/20
    pattern: '^\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}$'

properties:
  created:
    ref: '#/definitions/date_time'

  description:
    type: string

  display_doi:
    type: string

  doi:
    type: string

  entitytype:
    # TODO: This should be "entity_type": https://github.com/hubmapconsortium/entity-api/issues/24
    enum:
      - Sample
      - Donor

  hubmap_identifier:
    type: string

  image_file_metadata:
    type_TODO: https://github.com/hubmapconsortium/entity-api/issues/14
    type: array

  lab_donor_id:
    type: string

  lab_tissue_id:
    type: string

  label:
    type: string

  # TODO: What are these? Do we need all of them?
  metadata:
    type: string
  metadata_file:
    type_TODO: https://github.com/hubmapconsortium/entity-api/issues/14
    type: array
  metadatas:
    type_TODO: https://github.com/hubmapconsortium/entity-api/issues/14
    type: array

  modified:
    ref: '#/definitions/date_time'

  # TODO: What are these? Should they be enums?
  organ:
    type: string
  organ_other:
    type: string

  # TODO: Do we need all of these?
  protocol:
    type: string
    pattern_TODO: https://github.com/hubmapconsortium/entity-api/issues/18
    pattern: '^https?://'
  protocols:
    type_TODO: https://github.com/hubmapconsortium/entity-api/issues/14
    type: array
  protocol_file:
    type_TODO: https://github.com/hubmapconsortium/entity-api/issues/14
    type: string

  provenance_create_timestamp:
    ref: '#/definitions/time_stamp'

  provenance_group_name:
    type: string

  provenance_group_uuid:
    ref: '#/definitions/uuid'

  provenance_modified_timestamp:
    ref: '#/definitions/time_stamp'

  provenance_user_displayname:
    type: string

  provenance_user_email:
    type: string

  provenance_user_sub:
    type: string

  reference_uuid:
    ref: '#/definitions/uuid'

  sample_count:
    type_TODO: https://github.com/hubmapconsortium/entity-api/issues/25
    type: integer

  source_uuid:
    type: string

  specimen_type:
    enum:
      - fresh_frozen_section_slide
      - fresh_frozen_tissue
      - ffpe_block
      - organ

  user_group_uuid:
    ref: '#/definitions/uuid'

  uuid:
    ref: '#/definitions/uuid'
